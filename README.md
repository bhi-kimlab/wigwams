algorithm & code author: https://www.ncbi.nlm.nih.gov/pubmed/24351708

/w minor bug fixes and patches by @lazykuna.
